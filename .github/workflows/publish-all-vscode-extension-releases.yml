name: Publish All VSCode Extension Releases

on:
  workflow_dispatch:
    inputs:
      version:
        description: version of the extension, i.e. '1.56.0'
        required: true
        type: string

env:
  AWS_ACCESS_KEY_ID: ${{ secrets.CDN_S3_ACCESS_KEY }}
  AWS_SECRET_ACCESS_KEY: ${{ secrets.CDN_S3_SECRET_KEY  }}
  AWS_DEFAULT_REGION: us-east-1
  AWS_ENDPOINT_URL_S3:  ${{ secrets.CDN_S3_ENDPOINT }}
  AWS_S3_BUCKET: ${{ secrets.CDN_BUCKET }}/spring-tools
  DOWNLOAD_URL_ROOT: https://cdn.spring.io/spring-tools

jobs:

  publish-vscode-releases:
    runs-on: ubuntu-latest
    name: Publish '${{ inputs.version }}'
    steps:
      - name: Search for Releases
        id: search-releases
        run: |
          aws s3 ls s3://$AWS_S3_BUCKET/release/vscode-extensions/
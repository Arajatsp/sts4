name: Test Akamai Upload

on:
  workflow_dispatch:

jobs:
  akamai-upload:
    name: Upload to Akamai
    runs-on: ubuntu-latest
    steps:
    - name: Gen file and upload
      id: gen-upload
      env:
        AWS_ACCESS_KEY_ID: ${{ secrets.TOOLS_CLOUDGATE_ACCESS_KEY }}
        AWS_SECRET_ACCESS_KEY: ${{ secrets.TOOLS_CLOUDGATE_SECRET_KEY  }}
        AWS_DEFAULT_REGION: us-east-1
      run: |
        file="upload-test.txt"
        echo 'Upload test file' > $file
        cat $file
        aws s3 mv ./$file s3://tools-spring-io/test-akamai/$file --acl public-read --no-progress
